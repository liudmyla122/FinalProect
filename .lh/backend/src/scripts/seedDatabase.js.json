{
    "sourceFile": "backend/src/scripts/seedDatabase.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1769702557678,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770809609951,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -234,28 +234,23 @@\n     console.log('‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ—á–∏—â–µ–Ω–∞')\n \n     console.log('üë• –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...')\n \n-    const createdUsers = []\n-    for (const userData of testUsers) {\n-      const salt = await bcrypt.genSalt(10)\n-      const hashedPassword = await bcrypt.hash(userData.password, salt)\n-\n-      const user = new User({\n+    const salt = await bcrypt.genSalt(10)\n+    const hashedTestUsers = await Promise.all(\n+      testUsers.map(async (userData) => ({\n         ...userData,\n-        password: hashedPassword,\n-      })\n+        password: await bcrypt.hash(userData.password, salt),\n+      }))\n+    )\n \n-      await user.save()\n-      createdUsers.push(user)\n-      console.log(`   ‚úì –°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.username} (${user.email})`)\n-    }\n+    const createdUsers = await User.insertMany(hashedTestUsers)\n     console.log(`‚úÖ –°–æ–∑–¥–∞–Ω–æ ${createdUsers.length} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π`)\n \n     console.log('üîó –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏...')\n+    \n     for (let i = 0; i < createdUsers.length; i++) {\n       const user = createdUsers[i]\n-\n       const followingCount = Math.floor(Math.random() * 3) + 2\n       const following = []\n       for (let j = 0; j < followingCount; j++) {\n         const targetIndex = (i + j + 1) % createdUsers.length\n@@ -311,4 +306,5 @@\n   }\n }\n \n seedDatabase()\n+\n"
                },
                {
                    "date": 1770810014920,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -248,9 +248,12 @@\n \n     console.log('üîó –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏...')\n \n     for (let i = 0; i < createdUsers.length; i++) {\n-      const user = createdUsers[i]\n+      // Re-fetch user to ensure we have the latest version (avoid VersionError)\n+      const user = await User.findById(createdUsers[i]._id)\n+      if (!user) continue\n+\n       const followingCount = Math.floor(Math.random() * 3) + 2\n       const following = []\n       for (let j = 0; j < followingCount; j++) {\n         const targetIndex = (i + j + 1) % createdUsers.length\n"
                }
            ],
            "date": 1769702557678,
            "name": "Commit-0",
            "content": "const mongoose = require('mongoose');\nconst bcrypt = require('bcrypt');\nrequire('dotenv').config();\n\nconst User = require('../models/userModel');\nconst Post = require('../models/postModel');\nconst connectDB = require('../config/db');\n\n\nconst testUsers = [\n  {\n    email: 'sashaa@example.com',\n    username: 'sashaa',\n    fullName: 'Sasha Anderson',\n    password: 'password123',\n    avatar: '',\n    bio: 'Photographer and traveler üåç',\n  },\n  {\n    email: 'igor@example.com',\n    username: 'igor',\n    fullName: 'Igor Petrov',\n    password: 'password123',\n    avatar: '',\n    bio: 'Developer and designer üíª',\n  },\n  {\n    email: 'marija@example.com',\n    username: 'marija',\n    fullName: 'Marija Novak',\n    password: 'password123',\n    avatar: '',\n    bio: 'Artist and creator üé®',\n  },\n  {\n    email: 'alex@example.com',\n    username: 'alex',\n    fullName: 'Alex Johnson',\n    password: 'password123',\n    avatar: '',\n    bio: 'Fitness enthusiast üí™',\n  },\n  {\n    email: 'lisa@example.com',\n    username: 'lisa',\n    fullName: 'Lisa Brown',\n    password: 'password123',\n    avatar: '',\n    bio: 'Food blogger üçï',\n  },\n  {\n    email: 'david@example.com',\n    username: 'david',\n    fullName: 'David Wilson',\n    password: 'password123',\n    avatar: '',\n    bio: 'Musician and producer üéµ',\n  },\n  {\n    email: 'emma@example.com',\n    username: 'emma',\n    fullName: 'Emma Davis',\n    password: 'password123',\n    avatar: '',\n    bio: 'Writer and poet üìù',\n  },\n  {\n    email: 'mike@example.com',\n    username: 'mike',\n    fullName: 'Mike Taylor',\n    password: 'password123',\n    avatar: '',\n    bio: 'Adventure seeker üèîÔ∏è',\n  },\n];\n\n\nconst createTestPosts = async (users) => {\n  const posts = [\n    {\n      user: users[0]._id, \n      image: '/images/posts/post1.jpg',\n      caption: 'Beautiful sunset today! üåÖ #sunset #nature #photography',\n      likes: [users[1]._id, users[2]._id, users[3]._id],\n      comments: [\n        {\n          user: users[1]._id,\n          text: 'Amazing shot! üî•',\n        },\n        {\n          user: users[2]._id,\n          text: 'Love this! ‚ù§Ô∏è',\n        },\n      ],\n    },\n    {\n      user: users[1]._id, \n      image: '/images/posts/post2.jpg',\n      caption: 'Working on a new project. Stay tuned! üíª #coding #developer',\n      likes: [users[0]._id, users[2]._id, users[4]._id],\n      comments: [\n        {\n          user: users[0]._id,\n          text: 'Looking great!',\n        },\n      ],\n    },\n    {\n      user: users[1]._id, \n      image: '/images/posts/post3.jpg',\n      caption: 'Weekend vibes üéâ #weekend #fun',\n      likes: [users[0]._id, users[3]._id, users[5]._id],\n      comments: [],\n    },\n    {\n      user: users[2]._id, \n      image: '/images/posts/post4.jpg',\n      caption: 'New artwork in progress üé® #art #creative',\n      likes: [users[0]._id, users[1]._id, users[4]._id, users[6]._id],\n      comments: [\n        {\n          user: users[0]._id,\n          text: 'Stunning! ‚ú®',\n        },\n        {\n          user: users[1]._id,\n          text: 'Incredible work!',\n        },\n      ],\n    },\n    {\n      user: users[3]._id, \n      image: '/images/posts/post1.jpg',\n      caption: 'Morning workout complete! üí™ #fitness #health',\n      likes: [users[1]._id, users[2]._id],\n      comments: [\n        {\n          user: users[1]._id,\n          text: 'Keep it up!',\n        },\n      ],\n    },\n    {\n      user: users[4]._id, \n      image: '/images/posts/post2.jpg',\n      caption: 'Delicious homemade pasta üçù #food #cooking',\n      likes: [users[0]._id, users[2]._id, users[3]._id, users[5]._id],\n      comments: [\n        {\n          user: users[0]._id,\n          text: 'Recipe please! üòã',\n        },\n      ],\n    },\n    {\n      user: users[5]._id, \n      image: '/images/posts/post3.jpg',\n      caption: 'New track dropping soon! üéµ #music #producer',\n      likes: [users[1]._id, users[4]._id, users[6]._id],\n      comments: [],\n    },\n    {\n      user: users[6]._id, \n      image: '/images/posts/post4.jpg',\n      caption: 'Words have power ‚úçÔ∏è #writing #poetry',\n      likes: [users[0]._id, users[2]._id, users[5]._id],\n      comments: [\n        {\n          user: users[2]._id,\n          text: 'Beautiful words!',\n        },\n      ],\n    },\n    {\n      user: users[7]._id, \n      image: '/images/posts/post1.jpg',\n      caption: 'Mountain adventure! üèîÔ∏è #adventure #nature',\n      likes: [users[0]._id, users[1]._id, users[3]._id, users[4]._id],\n      comments: [\n        {\n          user: users[0]._id,\n          text: 'Epic!',\n        },\n        {\n          user: users[1]._id,\n          text: 'Amazing view!',\n        },\n      ],\n    },\n    {\n      user: users[0]._id, \n      image: '/images/posts/post2.jpg',\n      caption: 'City lights at night üåÉ #city #night',\n      likes: [users[1]._id, users[2]._id, users[3]._id, users[4]._id, users[5]._id],\n      comments: [\n        {\n          user: users[1]._id,\n          text: 'Beautiful!',\n        },\n      ],\n    },\n  ];\n\n  return posts;\n};\n\nconst seedDatabase = async () => {\n  try {\n    \n    await connectDB();\n\n    console.log('üóëÔ∏è  –û—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...');\n    \n    await User.deleteMany({});\n    await Post.deleteMany({});\n    console.log('‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ—á–∏—â–µ–Ω–∞');\n\n    console.log('üë• –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...');\n    \n    const createdUsers = [];\n    for (const userData of testUsers) {\n      \n      const salt = await bcrypt.genSalt(10);\n      const hashedPassword = await bcrypt.hash(userData.password, salt);\n\n      const user = new User({\n        ...userData,\n        password: hashedPassword,\n      });\n\n      await user.save();\n      createdUsers.push(user);\n      console.log(`   ‚úì –°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.username} (${user.email})`);\n    }\n    console.log(`‚úÖ –°–æ–∑–¥–∞–Ω–æ ${createdUsers.length} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π`);\n\n    \n    console.log('üîó –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏...');\n    for (let i = 0; i < createdUsers.length; i++) {\n      const user = createdUsers[i];\n      \n      const followingCount = Math.floor(Math.random() * 3) + 2;\n      const following = [];\n      for (let j = 0; j < followingCount; j++) {\n        const targetIndex = (i + j + 1) % createdUsers.length;\n        if (targetIndex !== i) {\n          following.push(createdUsers[targetIndex]._id);\n        }\n      }\n      user.following = following;\n      await user.save();\n\n      \n      for (const followedUserId of following) {\n        const followedUser = await User.findById(followedUserId);\n        if (followedUser && !followedUser.followers.includes(user._id)) {\n          followedUser.followers.push(user._id);\n          await followedUser.save();\n        }\n      }\n    }\n    console.log('‚úÖ –°–≤—è–∑–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã');\n\n    console.log('üì∏ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤...');\n   \n    const postsData = await createTestPosts(createdUsers);\n    const createdPosts = [];\n    for (const postData of postsData) {\n      const post = new Post(postData);\n      await post.save();\n      createdPosts.push(post);\n\n     \n      const user = await User.findById(postData.user);\n      if (user) {\n        user.posts.push(post._id);\n        await user.save();\n      }\n    }\n    console.log(`‚úÖ –°–æ–∑–¥–∞–Ω–æ ${createdPosts.length} –ø–æ—Å—Ç–æ–≤`);\n\n    console.log('\\nüéâ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞!');\n    console.log('\\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:');\n    console.log(`   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${createdUsers.length}`);\n    console.log(`   - –ü–æ—Å—Ç–æ–≤: ${createdPosts.length}`);\n    console.log('\\nüîë –¢–µ—Å—Ç–æ–≤—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:');\n    console.log('   –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –ø–∞—Ä–æ–ª—å: password123');\n    console.log('   –ü—Ä–∏–º–µ—Ä—ã:');\n    testUsers.slice(0, 3).forEach((user) => {\n      console.log(`   - ${user.username} (${user.email})`);\n    });\n\n    process.exit(0);\n  } catch (error) {\n    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:', error);\n    process.exit(1);\n  }\n};\n\n\nseedDatabase();\n"
        }
    ]
}